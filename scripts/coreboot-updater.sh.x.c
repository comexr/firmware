#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f scripts/coreboot-updater.sh -o coreboot-updater_0.0.9-1_amd64/usr/bin/coreboot-updater 
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[2]))
	"\236\374\040\113\125\221\005\370\061\232\051\234\062\375\115\205"
	"\071\301\167"
#define      msg1_z	65
#define      msg1	((&data[32]))
	"\071\035\344\310\271\357\103\315\043\066\211\051\372\010\254\044"
	"\312\274\071\333\303\240\337\322\303\317\317\117\225\332\017\005"
	"\372\063\006\147\130\125\104\172\100\326\117\063\124\255\071\151"
	"\106\313\221\052\021\076\135\227\326\234\043\117\121\263\073\355"
	"\143\334\247\235\131\166\271\034\034\356\307\150\111\173\020\303"
	"\025\010\230\372\324"
#define      chk2_z	19
#define      chk2	((&data[105]))
	"\237\214\161\012\320\160\000\110\171\250\334\200\060\020\021\216"
	"\375\106\001\000\373\163"
#define      lsto_z	1
#define      lsto	((&data[126]))
	"\341"
#define      date_z	1
#define      date	((&data[127]))
	"\146"
#define      inlo_z	3
#define      inlo	((&data[128]))
	"\145\200\260"
#define      pswd_z	256
#define      pswd	((&data[178]))
	"\325\340\007\136\012\002\156\316\027\167\146\021\113\141\155\303"
	"\000\151\067\142\334\302\222\304\207\337\220\024\347\115\345\274"
	"\056\355\032\070\357\211\007\007\001\155\030\115\316\206\020\014"
	"\141\050\025\347\061\157\105\074\173\033\165\130\147\333\127\334"
	"\240\307\345\065\032\063\060\163\216\345\047\347\031\273\363\173"
	"\343\011\142\024\170\250\121\363\304\306\113\053\241\242\010\102"
	"\152\356\167\205\042\250\371\260\215\040\227\247\334\213\042\277"
	"\224\205\324\014\055\045\000\361\353\113\035\215\356\046\317\131"
	"\025\107\337\067\360\330\347\176\371\177\046\325\012\110\224\236"
	"\316\150\253\374\216\253\355\171\367\013\007\346\062\327\100\107"
	"\036\037\176\017\367\146\216\360\345\264\305\357\375\132\216\313"
	"\303\071\307\121\345\265\313\334\301\322\303\363\251\003\072\310"
	"\042\271\330\031\037\146\012\004\033\320\364\030\052\202\344\356"
	"\274\254\100\241\142\013\175\043\335\100\027\207\104\121\117\146"
	"\013\047\177\052\216\212\057\251\132\043\301\205\246\246\163\142"
	"\123\263\003\265\276\201\331\234\302\360\043\006\102\163\154\115"
	"\232\354\167\050\167\247\322\321\313\223\126\161\072\312\323\215"
	"\175\327\103\074\130\034\331\033\014\374\041\116\160\216\234\013"
	"\173\024\063\362\273\006\304\206\231\032\370\324\344\313\142\317"
	"\357\110\061\314\012\304\220\222\243\041\247\213\156\214\107\235"
	"\172\142\325\151\354\334\160\355\112\211\072\031\017\112\350\377"
	"\223\032\313\235\336\133\060\202\174\327\015\353\144\124\210\336"
	"\267\136\107\243"
#define      shll_z	10
#define      shll	((&data[489]))
	"\205\101\164\312\274\070\047\240\234\035\277\211\312"
#define      msg2_z	19
#define      msg2	((&data[501]))
	"\210\120\065\331\011\335\327\231\205\212\027\264\023\075\333\311"
	"\332\375\373\020"
#define      tst1_z	22
#define      tst1	((&data[523]))
	"\034\106\201\240\341\016\164\106\102\311\155\261\266\074\040\253"
	"\365\240\067\251\044\011\055\350\373\170\167\004"
#define      chk1_z	22
#define      chk1	((&data[549]))
	"\340\250\371\332\213\122\062\012\315\377\155\052\075\137\137\011"
	"\131\120\062\313\372\106\150"
#define      rlax_z	1
#define      rlax	((&data[571]))
	"\060"
#define      opts_z	1
#define      opts	((&data[572]))
	"\267"
#define      text_z	3127
#define      text	((&data[1163]))
	"\220\121\211\322\034\050\044\062\260\165\332\123\221\041\324\012"
	"\230\330\377\346\352\340\231\121\111\052\157\021\003\060\024\223"
	"\202\235\146\236\306\212\320\166\377\253\311\221\314\235\233\145"
	"\166\232\114\140\173\345\262\304\020\041\326\023\121\353\247\323"
	"\211\015\161\117\230\102\305\230\355\217\051\272\055\305\037\243"
	"\140\154\004\333\121\266\237\142\327\166\165\051\141\034\374\352"
	"\052\156\072\303\260\377\133\236\216\205\131\274\112\170\137\252"
	"\344\144\205\066\032\045\231\362\234\016\033\375\053\030\350\126"
	"\206\043\031\067\043\164\326\262\372\057\156\104\250\315\357\215"
	"\061\164\304\114\232\135\077\066\153\132\064\227\163\035\355\372"
	"\100\007\062\143\174\010\025\166\070\203\272\340\120\251\156\202"
	"\036\062\317\270\217\016\357\373\151\043\223\334\100\200\326\200"
	"\207\010\343\003\020\371\171\111\174\064\051\315\336\227\117\374"
	"\312\037\265\131\055\244\125\226\310\350\162\010\151\111\211\361"
	"\121\154\364\142\146\156\253\342\243\325\257\201\155\377\176\067"
	"\036\064\221\113\330\346\342\240\317\124\251\070\236\062\051\357"
	"\237\036\122\005\214\376\347\060\323\227\262\101\226\060\170\264"
	"\144\011\000\075\360\342\336\277\067\210\367\326\272\041\305\132"
	"\077\030\137\314\026\107\374\352\336\256\053\165\337\243\052\104"
	"\255\053\201\236\016\140\135\106\350\125\034\243\166\341\375\265"
	"\372\134\201\020\244\176\372\203\054\046\370\014\311\043\120\167"
	"\116\322\025\134\062\163\242\033\310\276\276\076\240\274\364\233"
	"\031\166\253\275\364\246\100\040\314\071\055\226\135\175\016\253"
	"\117\043\010\202\226\253\236\137\152\135\235\013\031\222\246\062"
	"\010\122\357\374\370\060\035\305\152\112\134\307\310\152\163\027"
	"\216\174\232\044\050\071\203\222\226\041\235\257\263\104\342\273"
	"\226\321\270\217\002\325\124\155\037\261\065\347\033\251\377\251"
	"\045\232\316\115\324\122\340\152\163\175\032\047\302\374\343\130"
	"\316\233\347\321\161\074\076\220\355\163\170\011\034\170\262\102"
	"\023\200\220\347\323\160\122\106\356\154\156\260\151\121\010\070"
	"\355\360\011\136\055\107\357\032\273\150\044\330\341\326\032\364"
	"\127\252\334\052\033\057\161\011\234\337\271\005\061\302\075\036"
	"\263\106\174\340\216\154\373\112\324\037\042\265\366\075\251\116"
	"\350\206\170\003\265\352\014\121\312\306\127\373\211\224\032\074"
	"\333\226\035\152\003\030\264\327\070\327\214\057\024\066\175\374"
	"\274\365\377\162\340\014\303\252\322\033\245\134\257\300\230\213"
	"\127\266\366\132\316\252\061\007\201\275\066\226\363\264\204\271"
	"\110\326\013\151\054\070\323\071\036\153\175\036\273\361\206\320"
	"\204\045\272\330\276\152\031\171\024\050\170\110\156\315\261\012"
	"\252\173\216\173\121\235\104\006\063\274\175\253\132\346\215\255"
	"\345\333\235\164\366\165\257\051\212\301\274\067\107\143\122\332"
	"\120\246\227\326\011\105\167\227\261\243\167\305\336\002\160\170"
	"\111\235\344\154\071\305\127\376\037\076\053\010\077\014\235\131"
	"\264\226\267\070\261\031\253\265\057\267\240\276\134\112\337\040"
	"\161\204\032\343\013\277\032\012\231\355\167\323\114\005\327\333"
	"\235\307\262\263\325\345\040\250\043\343\176\324\263\273\106\115"
	"\377\237\024\355\352\144\152\163\074\350\173\114\102\065\014\120"
	"\317\170\160\122\353\331\120\072\130\340\340\012\075\007\337\122"
	"\132\345\231\306\363\327\262\022\136\234\325\177\103\163\204\147"
	"\004\344\035\037\234\353\376\042\012\262\106\032\346\042\377\007"
	"\361\340\011\053\014\154\344\224\324\141\002\003\050\132\365\214"
	"\204\112\335\256\252\267\270\235\161\107\115\267\146\277\247\376"
	"\352\125\226\326\126\040\114\340\003\041\357\171\173\310\203\057"
	"\341\172\220\303\312\327\377\310\024\006\155\052\036\064\111\355"
	"\303\076\167\147\332\264\352\031\045\264\154\355\002\140\102\377"
	"\241\104\124\161\067\022\016\157\234\211\033\002\200\177\066\230"
	"\115\232\263\127\160\330\176\243\063\141\015\156\110\134\063\164"
	"\220\020\056\241\274\122\011\230\265\300\313\226\225\265\373\223"
	"\300\053\176\272\275\153\017\202\132\025\321\037\237\127\331\222"
	"\253\131\364\315\311\226\266\251\042\356\277\324\004\325\364\141"
	"\075\263\205\141\215\001\201\104\146\007\156\043\027\165\334\276"
	"\007\251\021\237\154\006\125\071\061\234\113\026\306\107\174\333"
	"\357\076\314\327\354\054\306\177\146\343\365\337\277\310\307\245"
	"\132\006\225\023\330\013\007\035\004\367\374\256\071\246\035\340"
	"\244\043\346\020\104\247\372\223\037\076\177\173\045\251\376\246"
	"\126\303\224\336\025\132\261\221\006\112\134\062\003\264\063\364"
	"\342\346\311\032\306\327\011\135\102\022\102\262\265\253\046\031"
	"\231\137\061\167\332\106\000\361\135\164\072\374\351\216\060\241"
	"\030\356\117\276\143\112\267\326\330\005\236\322\102\216\244\202"
	"\305\136\166\263\013\322\140\200\103\236\326\223\115\267\303\011"
	"\174\202\372\341\000\051\146\231\107\012\077\066\030\213\344\317"
	"\023\100\002\313\073\215\005\312\163\172\062\374\151\327\064\221"
	"\347\337\373\252\234\011\001\317\163\226\125\271\377\065\347\231"
	"\244\035\127\045\005\010\350\213\167\101\045\342\244\126\344\303"
	"\314\376\356\143\164\173\244\317\107\162\371\364\143\213\036\003"
	"\150\365\353\207\322\045\221\231\103\137\235\362\366\335\127\301"
	"\214\020\124\316\374\207\226\301\215\027\153\155\356\113\366\120"
	"\221\305\027\177\211\074\100\145\016\357\367\125\244\232\222\257"
	"\314\273\101\050\176\143\147\024\005\070\336\036\333\057\254\117"
	"\342\357\235\015\246\000\351\015\022\213\176\066\053\005\233\121"
	"\232\064\205\117\353\053\355\235\110\265\012\017\211\006\221\176"
	"\217\167\233\354\356\031\032\375\221\074\050\141\300\271\140\312"
	"\213\064\064\357\035\302\317\030\037\015\260\306\120\371\307\046"
	"\064\000\326\330\341\176\150\021\132\370\036\367\224\324\166\273"
	"\254\207\011\152\356\226\045\313\076\143\345\266\014\141\274\211"
	"\061\101\141\304\031\036\240\343\327\150\220\273\216\320\013\104"
	"\220\101\305\203\275\172\251\257\027\224\062\063\047\360\031\126"
	"\120\157\124\013\115\100\174\256\216\340\027\257\045\312\077\066"
	"\353\025\065\167\003\077\251\206\324\323\110\054\200\325\050\146"
	"\140\123\226\202\344\357\244\124\043\124\244\371\375\140\045\005"
	"\104\234\075\146\171\025\010\367\052\113\160\172\336\270\231\153"
	"\044\272\221\155\015\206\242\037\372\227\336\356\162\115\151\312"
	"\115\072\217\364\005\074\230\156\274\133\056\365\045\334\015\206"
	"\361\201\343\337\153\276\063\010\033\116\175\340\320\130\351\374"
	"\165\025\362\166\066\134\112\323\266\050\310\077\356\062\105\003"
	"\215\001\117\026\325\232\240\013\073\206\265\141\372\316\137\065"
	"\311\352\121\000\312\004\173\253\070\312\064\347\153\133\244\364"
	"\073\022\363\220\017\377\164\050\253\376\345\245\324\155\211\131"
	"\033\005\311\127\123\034\250\217\226\057\052\116\332\120\311\300"
	"\054\010\171\173\311\154\325\235\062\056\127\057\115\300\234\320"
	"\350\232\165\257\045\063\227\164\320\231\117\065\026\351\372\212"
	"\023\271\160\301\374\362\001\227\062\024\270\147\376\145\322\353"
	"\126\354\067\263\230\054\160\222\174\211\373\302\305\214\216\242"
	"\232\214\141\043\067\111\175\342\314\233\376\175\146\021\342\176"
	"\020\356\311\254\302\376\062\232\334\275\347\310\004\212\257\231"
	"\252\321\027\367\311\237\242\157\300\360\106\324\107\065\114\147"
	"\052\006\261\222\240\344\107\061\031\121\054\011\145\315\163\000"
	"\130\103\140\113\310\174\326\061\316\306\213\014\177\331\207\303"
	"\034\020\117\266\314\251\312\217\203\077\060\361\147\015\130\020"
	"\046\030\053\002\044\370\060\334\223\162\274\046\132\005\130\166"
	"\237\142\011\301\240\174\065\031\305\234\011\261\013\077\047\332"
	"\324\322\173\152\315\015\336\312\336\171\102\254\211\321\265\320"
	"\100\265\200\320\215\201\151\374\177\054\130\134\312\010\234\201"
	"\010\050\050\252\054\073\017\361\036\347\050\141\161\071\011\051"
	"\364\372\120\244\111\216\362\340\261\204\113\051\246\312\276\266"
	"\217\110\065\240\160\145\260\242\116\332\270\030\122\341\157\357"
	"\137\261\123\121\203\302\312\104\126\163\224\006\246\004\253\213"
	"\254\012\335\037\121\014\153\261\046\311\265\236\321\003\100\016"
	"\246\063\227\066\304\244\040\251\231\325\207\225\304\346\246\030"
	"\067\106\300\217\353\306\106\274\213\304\017\105\067\333\173\313"
	"\312\066\344\031\025\203\360\020\171\215\011\317\216\047\217\065"
	"\344\254\264\157\135\145\075\064\240\121\267\304\127\110\122\144"
	"\273\274\275\165\261\246\063\253\264\321\147\074\052\155\075\027"
	"\374\354\251\253\332\327\333\364\060\350\074\320\137\105\032\323"
	"\216\355\060\251\313\111\221\150\022\026\176\115\261\122\377\237"
	"\200\340\114\247\107\125\344\317\300\367\115\062\346\232\210\313"
	"\201\026\151\332\120\156\170\220\262\115\221\173\014\127\252\124"
	"\345\142\221\075\171\312\302\305\022\050\106\215\333\333\132\337"
	"\000\166\172\166\211\354\320\203\260\312\112\243\312\276\300\214"
	"\015\354\016\304\000\341\340\361\015\144\037\332\267\012\043\121"
	"\241\365\002\244\323\116\057\311\053\254\010\331\276\052\061\062"
	"\247\272\107\256\364\103\002\124\152\261\156\320\352\072\024\354"
	"\272\300\001\360\371\177\002\274\050\300\220\061\063\311\341\345"
	"\233\110\221\262\361\234\375\052\247\077\104\024\177\377\146\155"
	"\247\223\311\177\327\070\233\333\341\106\347\120\121\176\125\305"
	"\076\003\003\170\345\352\140\271\143\041\115\127\343\004\126\150"
	"\037\243\365\310\307\006\063\303\177\252\040\070\255\047\175\357"
	"\250\040\243\170\302\360\267\315\234\104\017\173\105\253\206\043"
	"\170\360\353\056\053\251\350\041\051\222\146\143\136\370\155\262"
	"\207\277\003\136\357\125\137\341\243\033\277\357\106\052\246\140"
	"\325\013\134\347\210\260\111\017\170\156\131\055\215\231\347\177"
	"\034\320\215\040\174\023\066\250\176\165\241\330\312\264\337\111"
	"\012\167\075\130\364\000\343\112\270\117\124\373\017\016\321\155"
	"\201\057\050\070\052\052\053\251\254\051\101\072\157\204\002\175"
	"\255\117\132\173\232\224\000\107\046\104\105\215\133\050\051\311"
	"\143\371\125\313\346\344\362\246\250\061\256\033\254\052\271\325"
	"\206\200\150\044\224\351\202\275\222\014\326\132\254\146\277\213"
	"\322\073\347\370\155\032\061\345\075\340\244\253\025\136\140\234"
	"\217\304\154\027\265\145\177\040\113\143\225\372\004\077\045\265"
	"\013\201\115\061\363\116\065\256\222\015\044\243\377\354\151\055"
	"\375\222\042\226\161\154\374\245\115\310\305\344\020\170\065\061"
	"\107\300\206\100\121\304\303\041\121\046\245\001\022\101\200\361"
	"\343\027\355\200\007\324\320\306\053\271\320\362\102\244\302\105"
	"\264\323\243\334\214\333\061\132\061\156\243\335\175\007\132\144"
	"\117\345\116\250\240\207\324\326\231\271\355\025\071\364\310\127"
	"\215\374\027\166\026\324\025\313\123\057\212\223\256\345\242\011"
	"\366\223\377\373\160\163\020\361\305\170\261\220\025\351\366\023"
	"\140\221\261\316\347\206\112\204\073\011\262\154\034\307\221\174"
	"\152\144\340\133\237\126\110\173\224\111\005\021\032\141\031\050"
	"\055\217\045\141\075\241\036\047\206\210\346\056\027\026\363\322"
	"\174\267\325\061\073\056\006\004\251\176\026\156\246\300\047\132"
	"\317\231\325\333\357\373\316\015\251\147\037\301\171\240\247\260"
	"\361\233\344\220\170\344\006\312\011\233\226\277\060\340\151\041"
	"\254\365\070\300\112\025\364\106\157\303\125\206\313\034\232\257"
	"\013\044\127\245\017\240\152\303\325\222\022\242\026\230\065\145"
	"\137\316\352\274\230\202\076\004\327\106\351\116\267\243\330\362"
	"\262\050\262\317\005\265\053\162\364\254\054\104\375\012\156\302"
	"\065\355\004\277\117\031\357\242\102\040\237\205\175\353\070\033"
	"\273\337\057\064\020\257\044\244\312\232\243\021\165\061\331\247"
	"\123\376\354\323\314\055\110\263\316\024\117\251\112\265\025\231"
	"\124\354\110\363\307\103\055\060\327\007\330\317\003\322\174\070"
	"\074\342\050\325\350\132\303\004\315\151\033\002\341\313\304\204"
	"\143\306\274\255\231\021\161\106\235\340\067\034\006\173\025\244"
	"\166\257\155\145\116\070\231\240\051\110\324\076\152\120\216\107"
	"\176\100\122\325\333\351\370\353\374\366\131\260\100\022\213\347"
	"\264\275\221\113\144\227\204\132\011\300\261\164\250\171\152\340"
	"\356\302\301\122\042\124\104\075\123\044\001\063\005\145\263\210"
	"\322\272\100\131\001\017\324\326\204\226\074\102\354\361\320\160"
	"\035\155\125\134\154\172\103\054\236\226\262\236\142\275\256\214"
	"\121\161\344\060\346\054\361\054\066\126\343\074\235\026\024\323"
	"\171\330\273\305\215\165\065\171\214\136\333\077\254\370\327\216"
	"\354\200\106\047\044\220\203\264\153\315\102\334\120\351\123\006"
	"\316\241\160\207\064\102\216\016\370\011\264\216\231\154\014\126"
	"\216\176\135\237\063\335\001\116\077\341\135\367\133\207\177\124"
	"\013\006\102\335\147\043\227\213\201\047\352\371\015\217\207\317"
	"\254\071\323\352\252\326\332\332\235\066\217\100\305\307\221\056"
	"\253\201\327\350\223\352\316\045\032\054\331\005\156\231\371\231"
	"\006\231\223\133\356\057\131\367\101\365\226\317\040\027\201\244"
	"\237\044\066\007\004\002\211\174\217\112\175\254\254\207\104\370"
	"\306\277\252\016\100\165\274\245\133\143\057\246\047\061\007\122"
	"\303\276\200\144\113\073\116\001\124\106\123\357\220\117\205\112"
	"\376\201\052\170\031\177\211\313\202\324\267\036\333\260\310\377"
	"\344\017\377\052\120\113\166\303\071\132\237\204\240\222\370\064"
	"\256\253\325\232\154\213\304\325\273\264\251\305\075\101\151\353"
	"\177\277\375\021\116\327\346\177\243\112\363\064\156\335\322\012"
	"\161\076\055\275\145\175\375\042\367\142\041\275\077\353\336\310"
	"\133\272\253\031\375\146\244\150\347\032\013\270\361\274\272\136"
	"\336\362\277\212\067\114\050\044\110\246\172\005\277\167\202\373"
	"\046\331\245\314\247\061\231\122\165\151\353\003\123\355\105\307"
	"\233\164\207\253\143\314\374\351\234\207\237\271\077\201\155\234"
	"\274\161\320\127\266\267\306\023\135\326\011\231\354\331\351\346"
	"\070\017\227\321\151\015\003\067\247\034\150\241\333\367\104\167"
	"\156\135\346\127\140\352\222\170\343\321\124\246\026\273\173\106"
	"\256\351\052\151\060\026\002\165\202\147\041\274\167\323\235\315"
	"\212\213\003\210\345\137\142\300\137\100\113\233\304\153\034\216"
	"\203\076\235\226\372\325\322\154\233\034\034\277\070\251\124\205"
	"\160\003\234\307\361\043\314\065\062\053\352\125\261\167\073\176"
	"\030\301\372\200\163\075\172\041\250\164\163\356\012\205\323\151"
	"\056\352\201\200\010\047\206\045\026\212\242\072\265\144\253\016"
	"\122\060\335\262\345\030\304\235\231\054\214\357\364\255\171\125"
	"\147\334\226\014\370\063\376\102\010\025\032\321\135\367\343\364"
	"\000\141\102\260\051\076\161\341\111\371\372\334\260\257\271\053"
	"\015\243\154\306\213\357\125\064\266\277\374\231\170\116\022\164"
	"\116\305\321\015\261\314\374\015\174\237\355\156\123\324\353\023"
	"\371\004\307\021\327\033\156\341\037\120\120\307\116\216\243\314"
	"\327\167\115\134\131\213\212\330\376\352\303\036\042\227\372\173"
	"\334\030\114\103\013\217\373\111\277\107\105\376\365\004\301\277"
	"\102\202\073\042\037\354\110\033\063\165\326\130\040\231\254\372"
	"\056\210\324\131\306\033\116\314\142\320\211\026\173\077\246\225"
	"\161\061\373\050\265\225\057\262\154\061\352\025\273\265\344\262"
	"\136\065\116\125\205\223\040\252\257\036\331\121\354\233\075\025"
	"\131\046\372\266\113\011\201\345\067\242\235\207\034\331\314\112"
	"\117\233\157\103\222\367\303\322\174\237\330\327\362\345\234\004"
	"\175\027\354\133\361\330\204\240\065\222\304\365\375\327\157\067"
	"\275\300\043\134\045\307\000\220\334\326\251\312\303\040\235\076"
	"\316\075\036\071\321\032\347\373\226\361\030\114\157\132\306\037"
	"\122\071\165\060\056\245\232\355\277\002\270\057\255\174\027\035"
	"\246\016\075\332\373\344\115\261\161\060\335\355\272\067\217\254"
	"\064\335\242\076\234\135\306\122\243\147\275\216\030\024\103\337"
	"\301\072\243\162\041\124\212\370\110\000\302\161\130\245\162\311"
	"\005\375\327\321\243\014\130\311\055\023\323\275\101\033\364\276"
	"\035\231\062\347\143\010\171\236\203\303\141\376\034\104\315\367"
	"\253\151\044\337\310\222\260\252\222\042\212\236\346\064"
#define      tst2_z	19
#define      tst2	((&data[4299]))
	"\215\107\073\110\077\252\027\375\267\252\135\222\036\256\273\055"
	"\221\261\112\316\261\232\146"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
